{
  "manifest": {
    "name": "@libp2p/interface-transport",
    "version": "2.1.3",
    "description": "Transport interface for libp2p",
    "license": "Apache-2.0 OR MIT",
    "homepage": "https://github.com/libp2p/js-libp2p-interfaces/tree/master/packages/interface-transport#readme",
    "repository": {
      "type": "git",
      "url": "git+https://github.com/libp2p/js-libp2p-interfaces.git"
    },
    "bugs": {
      "url": "https://github.com/libp2p/js-libp2p-interfaces/issues"
    },
    "keywords": [
      "interface",
      "libp2p"
    ],
    "engines": {
      "node": ">=16.0.0",
      "npm": ">=7.0.0"
    },
    "type": "module",
    "types": "./dist/src/index.d.ts",
    "files": [
      "src",
      "dist",
      "!dist/test",
      "!**/*.tsbuildinfo"
    ],
    "exports": {
      ".": {
        "types": "./dist/src/index.d.ts",
        "import": "./dist/src/index.js"
      }
    },
    "eslintConfig": {
      "extends": "ipfs",
      "parserOptions": {
        "sourceType": "module"
      }
    },
    "release": {
      "branches": [
        "master"
      ],
      "plugins": [
        [
          "@semantic-release/commit-analyzer",
          {
            "preset": "conventionalcommits",
            "releaseRules": [
              {
                "breaking": true,
                "release": "major"
              },
              {
                "revert": true,
                "release": "patch"
              },
              {
                "type": "feat",
                "release": "minor"
              },
              {
                "type": "fix",
                "release": "patch"
              },
              {
                "type": "docs",
                "release": "patch"
              },
              {
                "type": "test",
                "release": "patch"
              },
              {
                "type": "deps",
                "release": "patch"
              },
              {
                "scope": "no-release",
                "release": false
              }
            ]
          }
        ],
        [
          "@semantic-release/release-notes-generator",
          {
            "preset": "conventionalcommits",
            "presetConfig": {
              "types": [
                {
                  "type": "feat",
                  "section": "Features"
                },
                {
                  "type": "fix",
                  "section": "Bug Fixes"
                },
                {
                  "type": "chore",
                  "section": "Trivial Changes"
                },
                {
                  "type": "docs",
                  "section": "Documentation"
                },
                {
                  "type": "deps",
                  "section": "Dependencies"
                },
                {
                  "type": "test",
                  "section": "Tests"
                }
              ]
            }
          }
        ],
        "@semantic-release/changelog",
        "@semantic-release/npm",
        "@semantic-release/github",
        "@semantic-release/git"
      ]
    },
    "scripts": {
      "clean": "aegir clean",
      "lint": "aegir lint",
      "dep-check": "aegir dep-check",
      "build": "aegir build",
      "release": "aegir release"
    },
    "dependencies": {
      "@libp2p/interface-connection": "^4.0.0",
      "@libp2p/interface-stream-muxer": "^3.0.0",
      "@libp2p/interfaces": "^3.0.0",
      "@multiformats/multiaddr": "^12.0.0",
      "it-stream-types": "^1.0.4"
    },
    "devDependencies": {
      "aegir": "^38.1.0"
    },
    "typedoc": {
      "entryPoint": "./src/index.ts"
    },
    "_registry": "npm",
    "_loc": "/home/ubuntu/.cache/yarn/v6/npm-@libp2p-interface-transport-2.1.3-integrity/node_modules/@libp2p/interface-transport/package.json",
    "readmeFilename": "README.md",
    "readme": "# @libp2p/interface-transport <!-- omit in toc -->\n\n[![libp2p.io](https://img.shields.io/badge/project-libp2p-yellow.svg?style=flat-square)](http://libp2p.io/)\n[![Discuss](https://img.shields.io/discourse/https/discuss.libp2p.io/posts.svg?style=flat-square)](https://discuss.libp2p.io)\n[![codecov](https://img.shields.io/codecov/c/github/libp2p/js-libp2p-interfaces.svg?style=flat-square)](https://codecov.io/gh/libp2p/js-libp2p-interfaces)\n[![CI](https://img.shields.io/github/actions/workflow/status/libp2p/js-libp2p-interfaces/js-test-and-release.yml?branch=master\\&style=flat-square)](https://github.com/libp2p/js-libp2p-interfaces/actions/workflows/js-test-and-release.yml?query=branch%3Amaster)\n\n> Transport interface for libp2p\n\n## Table of contents <!-- omit in toc -->\n\n- [Install](#install)\n- [Modules that implement the interface](#modules-that-implement-the-interface)\n- [Badge](#badge)\n- [How to use the battery of tests](#how-to-use-the-battery-of-tests)\n- [Node.js](#nodejs)\n- [API](#api)\n  - [Types](#types)\n    - [Upgrader](#upgrader)\n    - [MultiaddrConnection](#multiaddrconnection)\n  - [Creating a transport instance](#creating-a-transport-instance)\n  - [Dial to another peer](#dial-to-another-peer)\n  - [Canceling a dial](#canceling-a-dial)\n  - [Filtering Addresses](#filtering-addresses)\n  - [Create a listener](#create-a-listener)\n  - [Start a listener](#start-a-listener)\n  - [Get listener addrs](#get-listener-addrs)\n  - [Stop a listener](#stop-a-listener)\n- [API Docs](#api-docs)\n- [License](#license)\n- [Contribution](#contribution)\n\n## Install\n\n```console\n$ npm i @libp2p/interface-transport\n```\n\nThe primary goal of this module is to enable developers to pick and swap their transport module as they see fit for their libp2p installation, without having to go through shims or compatibility issues. This module and test suite were heavily inspired by abstract-blob-store, interface-stream-muxer and others.\n\nPublishing a test suite as a module lets multiple modules all ensure compatibility since they use the same test suite.\n\nThe purpose of this interface is not to reinvent any wheels when it comes to dialing and listening to transports. Instead, it tries to provide a uniform API for several transports through a shimmed interface.\n\n## Modules that implement the interface\n\n- [js-libp2p-tcp](https://github.com/libp2p/js-libp2p-tcp)\n- [js-libp2p-webrtc-star](https://github.com/libp2p/js-libp2p-webrtc-star)\n- [js-libp2p-webrtc-direct](https://github.com/libp2p/js-libp2p-webrtc-direct)\n- [js-libp2p-websocket-star](https://github.com/libp2p/js-libp2p-websocket-star)\n- [js-libp2p-websockets](https://github.com/libp2p/js-libp2p-websockets)\n- [js-libp2p-utp](https://github.com/libp2p/js-libp2p-utp)\n- [webrtc-explorer](https://github.com/diasdavid/webrtc-explorer)\n\n## Badge\n\nInclude this badge in your readme if you make a module that is compatible with the interface-transport API. You can validate this by running the tests.\n\n![](img/badge.png)\n\n## How to use the battery of tests\n\n## Node.js\n\n```js\n/* eslint-env mocha */\n'use strict'\n\nconst tests = require('libp2p-interfaces-compliance-tests/transport')\nconst multiaddr = require('@multiformats/multiaddr')\nconst YourTransport = require('../src')\n\ndescribe('compliance', () => {\n  tests({\n    setup (init) {\n      let transport = new YourTransport(init)\n\n      const addrs = [\n        multiaddr('valid-multiaddr-for-your-transport'),\n        multiaddr('valid-multiaddr2-for-your-transport')\n      ]\n\n      const network = require('my-network-lib')\n      const connect = network.connect\n      const connector = {\n        delay (delayMs) {\n          // Add a delay in the connection mechanism for the transport\n          // (this is used by the dial tests)\n          network.connect = (...args) => setTimeout(() => connect(...args), delayMs)\n        },\n        restore () {\n          // Restore the connection mechanism to normal\n          network.connect = connect\n        }\n      }\n\n      return { transport, addrs, connector }\n    },\n    teardown () {\n      // Clean up any resources created by setup()\n    }\n  })\n})\n```\n\n## API\n\nA valid transport (one that follows the interface defined) must implement the following API:\n\n**Table of contents:**\n\n- type: `Transport`\n  - `new Transport({ upgrader, ...[options] })`\n  - `<Promise> transport.dial(multiaddr, [options])`\n  - `<Multiaddr[]> transport.filter(multiaddrs)`\n  - `transport.createListener([options], handlerFunction)`\n  - type: `transport.Listener`\n    - event: 'listening'\n    - event: 'close'\n    - event: 'connection'\n    - event: 'error'\n    - `<Promise> listener.listen(multiaddr)`\n    - `listener.getAddrs()`\n    - `<Promise> listener.close([options])`\n\n### Types\n\n#### Upgrader\n\nUpgraders have 2 methods: `upgradeOutbound` and `upgradeInbound`.\n\n- `upgradeOutbound` must be called and returned by `transport.dial`.\n- `upgradeInbound` must be called and the results must be passed to the `createListener` `handlerFunction` and the `connection` event handler, anytime a new connection is created.\n\n```js\nconst connection = await upgrader.upgradeOutbound(multiaddrConnection)\nconst connection = await upgrader.upgradeInbound(multiaddrConnection)\n```\n\nThe `Upgrader` methods take a [MultiaddrConnection](#multiaddrconnection) and will return an `interface-connection` instance.\n\n#### MultiaddrConnection\n\n- `MultiaddrConnection`\n  - `sink<function(source)>`: A [streaming iterable sink](https://gist.github.com/alanshaw/591dc7dd54e4f99338a347ef568d6ee9#sink-it)\n  - `source<AsyncIterator>`: A [streaming iterable source](https://gist.github.com/alanshaw/591dc7dd54e4f99338a347ef568d6ee9#source-it)\n  - `close<function(Error)>`: A method for closing the connection\n  - `conn`: The raw connection of the transport, such as a TCP socket.\n  - `remoteAddr<Multiaddr>`: The remote `Multiaddr` of the connection.\n  - `[localAddr<Multiaddr>]`: An optional local `Multiaddr` of the connection.\n  - `timeline<object>`: A hash map of connection time events\n    - `open<number>`: The time in ticks the connection was opened\n    - `close<number>`: The time in ticks the connection was closed\n\n### Creating a transport instance\n\n- `const transport = new Transport({ upgrader, ...[options] })`\n\nCreates a new Transport instance. `options` is an JavaScript object that should include the necessary parameters for the transport instance. Options **MUST** include an `Upgrader` instance, as Transports will use this to return `interface-connection` instances from `transport.dial` and the listener `handlerFunction`.\n\n**Note: Why is it important to instantiate a transport -** Some transports have state that can be shared between the dialing and listening parts. For example with libp2p-webrtc-star, in order to dial a peer, the peer must be part of some signaling network that is shared with the listener.\n\n### Dial to another peer\n\n- `const connection = await transport.dial(multiaddr, [options])`\n\nThis method uses a transport to dial a Peer listening on `multiaddr`.\n\n`multiaddr` must be of the type [`multiaddr`](https://www.npmjs.com/multiaddr).\n\n`[options]` the options that may be passed to the dial. Must support the `signal` option (see below)\n\nDial **MUST** call and return `upgrader.upgradeOutbound(multiaddrConnection)`. The upgrader will return an [interface-connection](../connection) instance.\n\nThe dial may throw an `Error` instance if there was a problem connecting to the `multiaddr`.\n\n### Canceling a dial\n\nDials may be cancelled using an `AbortController`:\n\n```Javascript\nconst { AbortError } = require('libp2p-interfaces/src/transport/errors')\nconst controller = new AbortController()\ntry {\n  const conn = await mytransport.dial(ma, { signal: controller.signal })\n  // Do stuff with conn here ...\n} catch (err: any) {\n  if(err.code === AbortError.code) {\n    // Dial was aborted, just bail out\n    return\n  }\n  throw err\n}\n\n// ----\n// In some other part of the code:\n  controller.abort()\n// ----\n```\n\n### Filtering Addresses\n\n- `const supportedAddrs = await transport.filter(multiaddrs)`\n\nWhen using a transport its important to be able to filter out `multiaddr`s that the transport doesn't support. A transport instance provides a filter method to return only the valid addresses it supports.\n\n`multiaddrs` must be an array of type [`multiaddr`](https://www.npmjs.com/multiaddr).\nFilter returns an array of `multiaddr`.\n\n### Create a listener\n\n- `const listener = transport.createListener([options], handlerFunction)`\n\nThis method creates a listener on the transport. Implementations **MUST** call `upgrader.upgradeInbound(multiaddrConnection)` and pass its results to the `handlerFunction` and any emitted `connection` events.\n\n`options` is an optional object that contains the properties the listener must have, in order to properly listen on a given transport/socket.\n\n`handlerFunction` is a function called each time a new connection is received. It must follow the following signature: `function (conn) {}`, where `conn` is a connection that follows the [`interface-connection`](../connection).\n\nThe listener object created may emit the following events:\n\n- `listening` - when the listener is ready for incoming connections\n- `close` - when the listener is closed\n- `connection` - (`conn`) each time an incoming connection is received\n- `error` - (`err`) each time there is an error on the connection\n\n### Start a listener\n\n- `await listener.listen(multiaddr)`\n\nThis method puts the listener in `listening` mode, waiting for incoming connections.\n\n`multiaddr` is the address that the listener should bind to.\n\n### Get listener addrs\n\n- `listener.getAddrs()`\n\nThis method returns the addresses on which this listener is listening. Useful when listening on port 0 or any interface (0.0.0.0).\n\n### Stop a listener\n\n- `await listener.close([options])`\n\nThis method closes the listener so that no more connections can be opened on this transport instance.\n\n`options` is an optional object that may contain the following properties:\n\n- `timeout` - A timeout value (in ms) after which all connections on this transport will be destroyed if the transport is not able to close gracefully. (e.g `{ timeout: 1000 }`)\n\n## API Docs\n\n- <https://libp2p.github.io/js-libp2p-interfaces/modules/_libp2p_interface_transport.html>\n\n## License\n\nLicensed under either of\n\n- Apache 2.0, ([LICENSE-APACHE](LICENSE-APACHE) / <http://www.apache.org/licenses/LICENSE-2.0>)\n- MIT ([LICENSE-MIT](LICENSE-MIT) / <http://opensource.org/licenses/MIT>)\n\n## Contribution\n\nUnless you explicitly state otherwise, any contribution intentionally submitted for inclusion in the work by you, as defined in the Apache-2.0 license, shall be dual licensed as above, without any additional terms or conditions.\n",
    "licenseText": "This project is dual licensed under MIT and Apache-2.0.\n\nMIT: https://www.opensource.org/licenses/mit\nApache-2.0: https://www.apache.org/licenses/license-2.0\n"
  },
  "artifacts": [],
  "remote": {
    "resolved": "https://registry.npmjs.org/@libp2p/interface-transport/-/interface-transport-2.1.3.tgz",
    "type": "tarball",
    "reference": "https://registry.npmjs.org/@libp2p/interface-transport/-/interface-transport-2.1.3.tgz",
    "hash": "",
    "integrity": "sha512-ez+0X+w2Wyw3nJY6mP0DHFgrRnln/miAH4TJLcRfUSJHjGXH5ZfpuK1TnRxXpEUiqOezSbwke06/znI27KpRiQ==",
    "registry": "npm",
    "packageName": "@libp2p/interface-transport",
    "cacheIntegrity": "sha512-ez+0X+w2Wyw3nJY6mP0DHFgrRnln/miAH4TJLcRfUSJHjGXH5ZfpuK1TnRxXpEUiqOezSbwke06/znI27KpRiQ== sha1-P7yEVwE6FVLSgaPZTueuByXMFuA="
  },
  "registry": "npm",
  "hash": "7b3fb45fec365b2c379c963a98fd031c582b467967fe68801f84c92dc45f5122478c65c7e597e9b8ad539d1c57a44522a8e7b349bc247b4ebfce7236ecaa5189"
}